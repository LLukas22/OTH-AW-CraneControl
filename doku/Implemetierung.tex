\chapter{Implementierung}


\section{Kinect - C\#}
\subsection{Konzept}
Kinect erkennt 3 Gesten + NotTracked + Unknown

\begin{figure}[H]
    \centering
    \subfigure[Offen]{\includegraphics[width=0.32\textwidth]{Geste_offen.jpg}}
    \subfigure[Geschlossen]{\includegraphics[width=0.32\textwidth]{Geste_geschlossen.jpg}}
    \subfigure[Lasso]{\includegraphics[width=0.32\textwidth]{Geste_lasso.jpg}}
    \caption[Kinect Gesten]{Kinect Gesten. Bildquelle: eigene Bilder}
	\label{fig:Kinect Gesten}
\end{figure}


\subsection{Code}
\subsubsection{Gestenerkennung}
\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \newcommand{\xa}{5};
        \newcommand{\xb}{3};
        \draw[draw=lightgray, step=1cm] (-{\xa}, -{\xa}) grid ({\xa}, {\xa});
        \draw[thick, -latex] (-{\xa+0.5}, 0) -- ({\xa-0.5}, 0) node[below] {$x$};
        \draw[thick, -latex] (0, -{\xa+0.5}) -- (0, {\xa-0.5}) node[right] {$y$};
        \node [draw] at (0,{\xa+0.5}) {UP};
        \node [draw] at (0,-{\xa-0.5}) {DOWN};
        \node [draw] at (-{\xa-1},0) {LEFT};
        \node [draw] at ({\xa+1},0) {RIGHT};
        \draw [draw=red, fill=red] (0,0) -- ({\xb},{\xa}) -- ({\xa},{\xa}) -- ({\xa},{\xb}) -- cycle;
        \draw [draw=red, fill=red] (0,0) -- (-{\xb},-{\xa}) -- (-{\xa},-{\xa}) -- (-{\xa},-{\xb}) -- cycle;
        \draw [draw=red, fill=red] (0,0) -- ({\xb},-{\xa}) -- ({\xa},-{\xa}) -- ({\xa},-{\xb}) -- cycle;
        \draw [draw=red, fill=red] (0,0) -- (-{\xb},{\xa}) -- (-{\xa},{\xa}) -- (-{\xa},{\xb}) -- cycle;
    \end{tikzpicture}
    \caption{Filter der Richtungsgesten.}
    \label{fig:Richtungsfilter}
\end{figure}
\subsubsection{Kinect}
Übernimmt die Initialiserung und Verabeitung der Kinect. Ausgegeben werden eine Bitmap des Bildes und in einem Array die Richtungsanweisungen.
Im Bild werden die erkannten Hände umrandet.

\subsubsection{Krahnsteuerung}
Ist das Hauptprogramm in dem das Winform und der Server gehandhabt werden.

\subsubsection{SharedRessources}
Klasse, in der die Übergabe an das Hauptprogramm geregelt wird, so dass dieses um andere Eingabemöglichkeiten erweitert werden könnte.

\subsection{UI}
UI
\begin{figure}[H]
    \centering
        \includegraphics[width=0.7\linewidth]{Kinect UI.png}
        \caption[Kinect UI]{Kinect UI}
        \label{fig:Kinect UI}
\end{figure}




\newpage
\section{Tensorflow - Python}
\subsection{Konzept}
Es wird ein Object-Detection-Model verwendet um über eine Webcam eine von sechs Gesten zu erkennen.
Die erkannte Geste wird in einem Buffer zwischengespeichert, und wenn mehrere Durchläufe das gleiche Ergebniss liefern wird ein Befehl an den Kran gesendet.

\begin{figure}[H]
    \centering
    \subfigure[Power]{\includegraphics[width=0.3\textwidth]{TensorFlow/Gestures/Power.PNG}}
    \subfigure[Up]{\includegraphics[width=0.3\textwidth]{TensorFlow/Gestures/Up.PNG}}
    \subfigure[Down]{\includegraphics[width=0.3\textwidth]{TensorFlow/Gestures/Down.PNG}}
    \subfigure[Left]{\includegraphics[width=0.3\textwidth]{TensorFlow/Gestures/Left.PNG}}
    \subfigure[Right]{\includegraphics[width=0.3\textwidth]{TensorFlow/Gestures/Right.PNG}}
    \subfigure[Toggle]{\includegraphics[width=0.3\textwidth]{TensorFlow/Gestures/Toggle.PNG}}
    \caption[Tensorflow Gesten]{Tensorflow Gesten. Bildquelle: eigene Bilder}
	\label{fig:Tensorflow Gesten}
\end{figure}
\newpage
\subsection{Tensorflow Trainer}
Um das tränieren der Modele zu erleichtern wurde eine C\# Application geschrieben, die diesen Vorgang weitgehend automatisiert.

\begin{figure}[H]
    \centering
    \subfigure{\includegraphics[width=0.9\textwidth]{TensorFlow/TensorflowTrainer.PNG}}
    \caption[Tensorflow Trainer]{Tensorflow Trainer}
	\label{fig:Tensorflow Trainer}
\end{figure}

\subsection{Tränieren eines eigene Models}

\subsubsection{Voraussetzungen:}

% \begin{tensorflowTrainerPrerequisites}[H]
%     \item Git (\url{https://git-scm.com/downloads})
%     \item C++ Build Tools (\url{https://visualstudio.microsoft.com/thank-you-downloading-visual-studio/?sku=BuildTools&rel=16})
%     \item Python 3.7.X or newer (\url{https://www.python.org/downloads/})
%     \item LabelImg (\url{https://github.com/tzutalin/labelImg})
%     \item Nvidia Gpu (optional but highly recommended)
%     \item Download Matching CUDA Version (\url{https://www.tensorflow.org/install/gpu})
%     \item Matching cuDNN Version (\url{https://developer.nvidia.com/cudnn})
% \end{tensorflowTrainerPrerequisites}




\textbf{TensorflowTrainer:} \\
    Git: \url{https://git-scm.com/downloads}\\
    Suppoerted Models: \url{https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md}\\
    Microsoft C++ Build Tools: \url{https://visualstudio.microsoft.com/thank-you-downloading-visual-studio/?sku=BuildTools&rel=16}\\
    Für GPU-Support: \url{https://www.tensorflow.org/install/gpu}\\


\textbf{Für PI:} \\
    TFLight : \url{https://www.tensorflow.org/lite/guide/python}\\
    Apt.Get : sudo apt-get install python3-pil python3-pil.imagetk libatlas-base-dev libhdf5-dev libhdf5-serial-dev libatlas-base-dev libjasper-dev libqtgui4 libqt4-test\\
    Pip3: pip3 install Pillow,opencv-python\\


